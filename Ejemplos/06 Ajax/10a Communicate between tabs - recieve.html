<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recibir Mensaje</title>
</head>

<body>
    <h1>Mensajes Recibidos</h1>
    <div id="Mensajes" />
</body>
<script>
    // Recibir Mensaje
    //
    window.addEventListener('storage', mensaje_recibido)
    function mensaje_recibido(ev) {
        console.log(ev)
        if (ev.key != 'mensaje') return; // Sólo tratamos los "mensajes" 
        var mensaje = JSON.parse(ev.newValue);
        if (!mensaje) return;

        if (mensaje.comando == 'hazloya') traza("Tengo que hacer una tarea importante", mensaje.uid);
        if (mensaje.comando == 'reset') traza("te borré todo", mensaje.uid);
    }

    function traza(com, text) {
        const mens = document.getElementById("Mensajes");
        const p = document.createElement("p");
        const txt = document.createTextNode(com + "-" + text + "[" + (new Date).getTime() + "]");
        p.appendChild(txt)
        mens.appendChild(p)
    }
</script>

</html>